<div class="bg-cream-light min-h-screen py-20 px-4">
  <div class="max-w-7xl mx-auto">
    <!-- Header -->
    <div class="mb-12">
      <h1
        class="text-4xl md:text-5xl font-heading font-bold text-primary uppercase tracking-[0.2em] mb-2"
      >
        Mon Panier
      </h1>
      <div
        class="flex flex-col md:flex-row md:items-center justify-between gap-4"
      >
        <p class="text-xs uppercase tracking-widest text-accent font-bold">
          {{ cartCount() }}
          {{
            cartCount() > 1
              ? 'produits dans votre panier'
              : 'produit dans votre panier'
          }}
        </p>
      </div>
    </div>

    <div
      class="bg-white border-l-4 border-accent shadow-sm p-4 flex items-center gap-4 mb-8"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        fill="none"
        viewBox="0 0 24 24"
        stroke-width="1.5"
        stroke="currentColor"
        class="w-6 h-6 text-accent flex-shrink-0"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          d="M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"
        />
      </svg>
      <div>
        <p
          class="text-[10px] font-bold text-primary uppercase tracking-wider mb-1"
        >
          Commande Invité
        </p>
        <p class="text-xs text-gray-500 font-medium">
          Vous pourrez commander en mode invité (sans compte) à l'étape
          suivante.
        </p>
      </div>
    </div>

    @if (cartItems().length > 0) {
      <div class="grid grid-cols-1 lg:grid-cols-3 gap-12 items-start">
        <!-- Cart Items List (Left Column) -->
        <div class="lg:col-span-2 space-y-6">
          @for (
            item of cartItems();
            track item.type === 'product' ? item.product?.id : item.pack?.id
          ) {
            <div
              class="bg-white p-6 shadow-sm border border-gray-100 flex flex-col md:flex-row items-center gap-8 group"
            >
              <!-- Item Image -->
              <div
                class="w-32 h-32 bg-cream overflow-hidden shadow-inner flex-shrink-0"
              >
                @if (item.type === 'product' && item.product) {
                  <img
                    [src]="item.product.mainImage"
                    [alt]="item.product.name"
                    class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-500"
                  />
                } @else if (item.type === 'pack' && item.pack) {
                  <img
                    [src]="item.pack.mainImage || ''"
                    [alt]="item.pack.name"
                    class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-500"
                  />
                }
              </div>

              <!-- Info -->
              <div class="flex-1 text-center md:text-left">
                @if (item.type === 'product' && item.product) {
                  <h3
                    class="text-lg font-heading font-bold text-primary uppercase tracking-wider mb-1"
                  >
                    {{ item.product.name }}
                  </h3>
                  <p
                    class="text-[10px] text-gray-400 uppercase tracking-widest"
                  >
                    {{ item.product.discountPrice || item.product.price }} TND
                    l'unité
                  </p>
                } @else if (item.type === 'pack' && item.pack) {
                  <h3
                    class="text-lg font-heading font-bold text-primary uppercase tracking-wider mb-1"
                  >
                    {{ item.pack.name }}
                  </h3>
                  <p
                    class="text-[10px] text-accent uppercase tracking-widest mb-1"
                  >
                    Pack Mariage (-5%)
                  </p>
                  <p
                    class="text-[10px] text-gray-400 uppercase tracking-widest"
                  >
                    {{ item.pack.price }} TND l'unité
                  </p>
                }
              </div>

              <!-- Quantity Controls -->
              <div class="flex items-center space-x-4">
                <div
                  class="flex items-center border border-gray-200 bg-gray-50 p-1"
                >
                  <button
                    (click)="
                      updateQuantity(
                        item.type === 'product'
                          ? item.product!.id
                          : item.pack!.id,
                        item.quantity - 1,
                        item.type
                      )
                    "
                    class="w-8 h-8 flex items-center justify-center text-primary hover:text-accent disabled:opacity-30 transition-colors"
                    [disabled]="item.quantity <= 1"
                  >
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      fill="none"
                      viewBox="0 0 24 24"
                      stroke-width="2"
                      stroke="currentColor"
                      class="w-4 h-4"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        d="M5 12h14"
                      />
                    </svg>
                  </button>
                  <span
                    class="w-10 text-center text-sm font-bold text-primary"
                    >{{ item.quantity }}</span
                  >
                  <button
                    (click)="
                      updateQuantity(
                        item.type === 'product'
                          ? item.product!.id
                          : item.pack!.id,
                        item.quantity + 1,
                        item.type
                      )
                    "
                    class="w-8 h-8 flex items-center justify-center text-primary hover:text-accent transition-colors"
                  >
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      fill="none"
                      viewBox="0 0 24 24"
                      stroke-width="2"
                      stroke="currentColor"
                      class="w-4 h-4"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        d="M12 4.5v15m7.5-7.5h-15"
                      />
                    </svg>
                  </button>
                </div>

                <div class="text-right min-w-[100px]">
                  <p class="text-lg font-bold text-primary">
                    {{ getItemTotal(item) }} TND
                  </p>
                  <button
                    (click)="
                      removeItem(
                        item.type === 'product'
                          ? item.product!.id
                          : item.pack!.id,
                        item.type
                      )
                    "
                    class="text-[10px] text-red-400 hover:text-red-600 uppercase tracking-widest font-bold mt-1 inline-flex items-center space-x-1"
                  >
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      fill="none"
                      viewBox="0 0 24 24"
                      stroke-width="1.5"
                      stroke="currentColor"
                      class="w-3 h-3"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"
                      />
                    </svg>
                    <span>Supprimer</span>
                  </button>
                </div>
              </div>
            </div>
          }

          <div class="pt-6 flex justify-between items-center">
            <a
              routerLink="/"
              class="text-xs uppercase tracking-widest font-bold text-primary hover:text-accent transition-colors flex items-center space-x-2"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
                class="w-4 h-4"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"
                />
              </svg>
              <span>Continuer mes achats</span>
            </a>
            <button
              (click)="clearCart()"
              class="text-xs uppercase tracking-widest font-bold text-gray-400 hover:text-red-500 transition-colors"
            >
              Vider le panier
            </button>
          </div>
        </div>

        <!-- Order Summary (Right Column) -->
        <div class="space-y-6">
          <div class="bg-primary p-8 shadow-2xl">
            <h2
              class="text-xl font-heading font-bold text-white uppercase tracking-widest mb-8"
            >
              Résumé de la commande
            </h2>

            <div class="space-y-4 mb-8">
              <div
                class="flex justify-between text-gray-400 uppercase tracking-widest text-[10px] font-bold"
              >
                <span>Total des produits :</span>
                <span>{{ cartTotal() }} TND</span>
              </div>
              <div
                class="flex justify-between text-white uppercase tracking-widest text-xs font-bold pt-4 border-t border-white/5"
              >
                <span>Total :</span>
                <span class="text-accent text-lg">{{ cartTotal() }} TND</span>
              </div>
            </div>

            <!-- Checkout Button -->
            <a
              routerLink="/checkout"
              class="w-full bg-accent text-white py-5 text-xs font-bold uppercase tracking-[0.3em] hover:bg-white hover:text-primary transition-all duration-300 shadow-xl flex items-center justify-center space-x-3 group text-center"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
                class="w-5 h-5 group-hover:scale-110 transition-transform"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M15.75 10.5V6a3.75 3.75 0 1 0-7.5 0v4.5m11.356-1.993 1.263 12c.07.665-.45 1.243-1.119 1.243H4.25a1.125 1.125 0 0 1-1.12-1.243l1.264-12A1.125 1.125 0 0 1 5.513 7.5h12.974c.576 0 1.059.435 1.119 1.007ZM8.625 10.5a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm7.5 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"
                />
              </svg>
              <span>Passer ma commande</span>
            </a>

            <!-- Help Section -->
            <div
              class="mt-12 pt-12 border-t border-white/5 text-center space-y-4"
            >
              <p class="text-[9px] text-gray-500 uppercase tracking-widest">
                Une question sur votre commande ?
              </p>
              <a
                href="https://wa.me/21629137955"
                class="flex items-center justify-center space-x-3 p-4 bg-white/5 border border-white/10 hover:border-accent transition-all group"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke-width="1.5"
                  stroke="currentColor"
                  class="w-4 h-4 text-accent"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 0 0 2.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.387a12.035 12.035 0 0 1-7.143-7.143c-.155-.44.01-.927.387-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 0 0-1.091-.852H4.5A2.25 2.25 0 0 0 2.25 4.5v2.25Z"
                  />
                </svg>
                <span
                  class="text-sm font-bold text-white group-hover:text-accent font-heading"
                  >+216 29 137 955</span
                >
              </a>
            </div>
          </div>
        </div>
      </div>
    } @else {
      <!-- Empty Cart State -->
      <div class="py-32 text-center bg-white shadow-sm border border-gray-100">
        <div class="text-cream mb-6">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="1"
            stroke="currentColor"
            class="w-32 h-32 mx-auto"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M15.75 10.5V6a3.75 3.75 0 1 0-7.5 0v4.5m11.356-1.993 1.263 12c.07.665-.45 1.243-1.119 1.243H4.25a1.125 1.125 0 0 1-1.12-1.243l1.264-12A1.125 1.125 0 0 1 5.513 7.5h12.974c.576 0 1.059.435 1.119 1.007ZM8.625 10.5a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm7.5 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"
            />
          </svg>
        </div>
        <h2
          class="text-2xl font-heading font-bold text-primary uppercase tracking-widest mb-4"
        >
          Votre panier est vide
        </h2>
        <p class="text-gray-400 mb-8 uppercase tracking-widest text-[10px]">
          Découvrez nos collections pour le remplir !
        </p>
        <a
          routerLink="/category/salon"
          class="inline-block bg-primary text-white py-4 px-12 text-[10px] font-bold uppercase tracking-[0.3em] hover:bg-accent transition-all duration-300 shadow-xl"
        >
          Explorer la boutique
        </a>
      </div>
    }
  </div>
</div>
